---
import Layout from '~/layouts/PageLayout.astro';
import { fetchArticle, fetchArticles } from '~/services/api.js';

// Fonction pour récupérer les chemins dynamiques
export async function getStaticPaths() {
  const articles = await fetchArticles();

  // Retourne un tableau d'objets contenant les chemins
  return articles.map((article) => ({
    params: { id: article.id }, // Chemins basés sur les IDs des articles
  }));
}

// Récupération de l'ID depuis l'URL
const { id } = Astro.params;

// Chargement de l'article spécifique
const article = await fetchArticle(id);

if (!article) {
  throw new Error('Article introuvable ou données invalides');
}
---

<Layout metadata={{ title: article.titre }}>
  <section class="max-w-5xl mx-auto space-y-4">
    <button onclick="history.back()" class="text-blue-500 underline">← Retour</button>
    <h1 class="text-3xl font-bold">{article.titre || 'Titre indisponible'}</h1>
    <article class="prose max-w-none">
      <p>{article.contenu || 'Contenu indisponible.'}</p>
    </article>
  </section>
</Layout>
